# =========================
# Development Dockerfile
# =========================
FROM golang:1.25-alpine AS development

# 1. Install development tools
# - 'git' is required for 'go install' to fetch packages
# - 'make' is required for your CMD
RUN apk add --no-cache git make

# 2. Set the working directory
WORKDIR /app

# 3. Install 'air' (the Go live-reloader)
#    This is the new official repo path
RUN go install github.com/air-verse/air@latest

# 4. === CACHING ===
#    Copy *only* the mod files first
COPY go.mod go.sum ./

# 5. Download dependencies
#    This layer is cached. It will only re-run if go.mod/go.sum change.
RUN go mod download

# 6. Set the default command to run 'make dev'
#    When the container starts, it will find the dependencies
#    already downloaded and use the code from your 'volumes' mount.
CMD ["make", "dev"]
